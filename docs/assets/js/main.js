"use strict";const searchText=document.querySelector(".js_formInput"),searchButton=document.querySelector(".js-formButton"),listSeries=document.querySelector(".js-searchResult"),requestPanel=document.querySelector(".js-form"),listFav=document.querySelector(".js-favListCompleted");let series=[],favorites=[];function handleSearch(){apiRequest(searchText.value)}function setInLocalStorage(){const e=JSON.stringify(favorites);localStorage.setItem("favorite",e)}function apiRequest(e){fetch("//api.tvmaze.com/search/shows?q="+e).then(e=>e.json()).then(e=>{const t=e;series=[];for(const e of t)series.push(e.show);paintSeries(),setInLocalStorage()})}function getLocalStorage(){const e=localStorage.getItem("favorite");if(null===e)favorites=[];else{const t=JSON.parse(e);favorites=t,paintFavorites()}}function paintSeries(){listSeries.innerHTML="";let e="",t="";for(const s of series){t=isFavorite(s)?"serie--favorite":"",e=`<li id=${s.id} class= "searchResult_elem js-searchResult_elem ${t}">`,null===s.image?e+=`<img class="searchResult_elem-img" \n        src="https://via.placeholder.com/210x295/ffffff/666666/?text=TV" \n        title=${s.name} alt=${s.name}/>`:e+=`<img class="searchResult_elem-img"\n        src=${s.image.medium}\n        title=${s.name} alt=${s.name}/>`,e+=`<h3>${s.name}</h3>`,e+="</li>",listSeries.innerHTML+=e,listenClickSeries()}}function isFavorite(e){return void 0!==favorites.find(t=>t.id===e.id)}function listenClickSeries(){const e=document.querySelectorAll(".js-searchResult_elem");for(const t of e)t.addEventListener("click",addFavorites)}function addFavorites(e){const t=parseInt(e.currentTarget.id),s=series.find(e=>e.id===t),i=favorites.findIndex(e=>e.id===t);-1===i?favorites.push(s):favorites.splice(i,1),paintSeries(),paintFavorites()}function paintFavorites(){listFav.innerHTML="";let e="";for(const t of favorites)e=`<li id=${t.id} class="fav_section-list js-favSectionList">`,e+=`<button id="${t.id}" class="js-deleteCross fav_elem-delete ">x</button>`,null===t.image?e+=`<img class="fav_elem-img"\n          src="https://via.placeholder.com/210x295/ffffff/666666/?text=TV" \n          title=${t.name} alt=${t.name}/>`:e+=`<img class="fav_elem-img"\n          src=${t.image.medium}\n          title=${t.name} alt=${t.name}/>`,e+=`<h4 class="fav_elem-serieTitle"> ${t.name}</h4>`,e+="</li>",setInLocalStorage(),listFav.innerHTML+=e,listenClickedFavorites()}function listenClickedFavorites(){const e=document.querySelectorAll(".js-deleteCross");for(const t of e)t.addEventListener("click",deleteFav)}function deleteFav(e){const t=parseInt(e.currentTarget.id),s=favorites.findIndex(e=>e.id===t);favorites.splice(s,1),paintSeries(),paintFavorites()}function favHidden(){const e=document.querySelector(".js-favArea");(e.innerHTML="")?e.classList.add("js-hidden"):e.classList.remove("js-hidden")}function handleForm(e){e.preventDefault()}getLocalStorage(),searchButton.addEventListener("click",handleSearch),requestPanel.addEventListener("submit",handleForm);